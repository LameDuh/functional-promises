{"version":3,"file":"umd.min.js","sources":["../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/construct.js","../node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../src/modules/errors.js","../src/modules/utils.js","../src/arrays.js","../src/conditional.js","../src/index.js","../src/promise.js","../src/monads.js","../src/events.js"],"sourcesContent":["export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","const { inherits } = require('util');\n\ninherits(FunctionalError, Error)\n\ninherits(FunctionalUserError, FunctionalError)\ninherits(FPCollectionError, FunctionalError)\ninherits(FPUnexpectedError, FunctionalError)\ninherits(FPInputError, FunctionalError)\ninherits(FPTimeout, FunctionalError)\n\nexport function FunctionalError(msg, options) {\n  if (!(this instanceof FunctionalError)) return new FunctionalError(...arguments)\n  if (typeof msg === 'object') {\n    options = msg\n    if ( options.message ) msg = options.message\n  }\n  Error.call(this, msg)\n  if (typeof msg === 'string') this.message = msg\n  if (typeof options === 'object') {\n    Object.getOwnPropertyNames(options)\n      .forEach(key => {\n        this[key] = options[key]\n      })\n  }\n  this.name = this.constructor.name\n  // Capturing stack trace, excluding constructor call from it.\n  Error.captureStackTrace(this)\n}\n\nexport function FunctionalUserError() {\n  if (!(this instanceof FunctionalUserError)) return new FunctionalUserError(...arguments)\n  FunctionalError.call(this, ...arguments)\n}\n\nexport function FPUnexpectedError() {\n  if (!(this instanceof FPUnexpectedError)) return new FPUnexpectedError(...arguments)\n  FunctionalError.call(this, ...arguments)\n}\n\nexport function FPInputError() {\n  if (!(this instanceof FPInputError)) return new FPInputError(...arguments)\n  FunctionalError.call(this, ...arguments)\n}\n\nexport function FPCollectionError() {\n  if (!(this instanceof FPCollectionError)) return new FPCollectionError(...arguments)\n  FunctionalError.call(this, ...arguments)\n}\n\nexport function FPTimeout() {\n  if (!(this instanceof FPTimeout)) return new FPTimeout(...arguments)\n  FunctionalError.call(this, ...arguments)\n}\n\n\n","const utils = {\n  isPromiseLike(p) { return !!(p && typeof p.then === 'function') },\n  isFunction(fn) { return typeof fn === 'function' },\n  isEnumerable(list) { return list && Array.isArray(list) || list && typeof list[Symbol.iterator] === 'function' },\n  isObject(o) { return !!Object.prototype.toString.call(o) === '[object Object]' },\n\n  flatten(arr) {\n    if (!Array.isArray(arr)) throw new Error('Method `flatten` requires valid array parameter')\n    return arr.reduce((results, item) => results.concat(Array.isArray(item) ? utils.flatten(item) : [item]), [])\n  },\n}\nexport default utils","import utils from './modules/utils'\nimport { FPInputError, FPCollectionError, FunctionalError } from './modules/errors'\nconst { isEnumerable } = utils\n\nexport default function(FP) {\n\n  return { map, find, findIndex, filter, flatMap, reduce }\n\n  function find(callback) { return _find.call(this, callback).then(({ item }) => item) }\n  function findIndex(callback) { return _find.call(this, callback).then(({ index }) => index) }\n\n  function _find(iterable, callback) {\n    if (this.steps) return this.addStep('_find', [...arguments])\n    if (typeof iterable === 'function') {\n      callback = iterable\n      iterable = this._FP.promise\n    }\n\n    return FP.resolve(iterable)\n      .filter(callback)\n      .then((results) => results[0] != undefined ? { item: results[0], index: results.indexOf(results[0]) } : { item: undefined, index: -1 })\n  }\n  \n  function flatMap(iterable, callback) {\n    if (this.steps) return this.addStep('flatMap', [...arguments])\n    if (typeof iterable === 'function') {\n      callback = iterable\n      iterable = this._FP.promise\n    }\n    \n    return FP.resolve(iterable)\n      .map(callback)\n      .reduce((acc, arr) => acc.concat(...arr), [])\n  }\n\n\n  function filter(iterable, callback) {\n    if (this.steps) return this.addStep('filter', [...arguments])\n    if (typeof iterable === 'function') {\n      callback = iterable\n      iterable = this._FP.promise\n    }\n\n    return reduce.call(this, iterable, (acc, item) => Promise.resolve(callback(item)).then(x => (x ? acc.concat([item]) : acc)), [])\n  }\n\n  function reduce(iterable, reducer, initVal) {\n    if (this.steps) return this.addStep('reduce', [...arguments])\n    if (typeof iterable === 'function') {\n      initVal = reducer\n      reducer = iterable\n      iterable = this._FP ? this._FP.promise : this\n    } else iterable = FP.resolve(iterable, this)\n\n    return new FP((resolve, reject) => {\n      return iterable.then(iterable => {\n        const iterator = iterable[Symbol.iterator]()\n        let i = 0\n\n        const next = total => {\n          const current = iterator.next()\n          if (current.done) return resolve(total)\n\n          Promise.all([total, current.value])\n            .then(([total, item]) => next(reducer(total, item, i++))).catch(reject)\n        }\n\n        next(initVal)\n      })\n    })\n  }\n  \n  /*eslint max-statements: [\"error\", 60]*/\n  function map(args, fn, options) {\n    if (this.steps) return this.addStep('map', [...arguments])\n    if (arguments.length === 1 && this && this._FP) {\n      fn = args\n      args = this && this._FP && this._FP.promise\n    }\n    let resolvedOrRejected = false\n    const threadLimit = Math.max(1, (this && this._FP && this._FP.concurrencyLimit || 1))\n    const innerValues = this && this._FP && this._FP.promise ? this._FP.promise : Promise.resolve(args)\n    let initialThread = 0\n    let errors = []\n    let count = 0\n    const results = []\n    const threadPool = new Set()\n    const threadPoolFull = () => threadPool.size >= threadLimit\n    const isDone = () => errors.length > this._FP.errors.limit || count >= args.length || resolvedOrRejected\n    const setResult = index => value => {\n      threadPool.delete(index)\n      results[index] = value\n      return value\n    }\n    return FP.resolve(new Promise((resolve, reject) => {\n      const resolveIt = x => {\n        // console.log('Action.resolve:', resolvedOrRejected, x)\n        if (resolvedOrRejected) { return null } else { resolvedOrRejected = true }\n        resolve(x)\n      }\n      const rejectIt = x => {\n        if (resolvedOrRejected) { return null } else { resolvedOrRejected = true }\n        // console.log('Action.reject:', resolvedOrRejected, x)\n        reject(x)\n      }\n      innerValues.then(items => {\n        if (!isEnumerable(items)) return reject(new FPCollectionError(`Value must be iterable! A '${typeof items}' was passed into FP.map()`))\n        args = [...items]\n        const complete = () => {\n          let action = null\n          if (errors.length > this._FP.errors.limit) action = rejectIt\n          if (isDone()) action = resolveIt\n          if (action) return Promise.all(results).then(data => action(results)) ? true : true\n          return false\n        }\n        const checkAndRun = val => {\n          // console.log('checkAndRun', count, resolvedOrRejected, val)\n          if (resolvedOrRejected) return\n          if (!complete() && !results[count]) runItem(count)\n          return val\n        }\n\n        const runItem = c => {\n          if (resolvedOrRejected) {return null} else {count++}\n          if (threadPoolFull()) return setTimeout(() => runItem(c), 0)\n          if (results[c]) return results[c]\n          threadPool.add(c)\n          // either get value with `fn(item)` or `item.then(fn)`\n          results[c] = Promise.resolve(args[c])\n            .then(val => fn(val, c, args))\n            .then(val => setResult(c)(val))\n            .then(checkAndRun)\n            .catch(err => {\n              this._FP.errors.count++\n              errors.push(err)\n              if (this._FP.errors.limit <= 0) {\n                rejectIt(err)\n                return err\n              }\n              if (errors.length > this._FP.errors.limit) {\n                let fpErr = errors.length >= 1 ? new FPCollectionError(`Error Limit ${this._FP.errors.limit} Exceeded.\n                idx=${c} errCnt=${this._FP.errors.count}`, { errors, results, ctx: this }) : err\n                Promise.resolve(setResult(c)(err)).then(() => rejectIt(fpErr))\n              } else { // console.warn('Error OK:', JSON.stringify(this._FP.errors))\n                return Promise.resolve().then(() => setResult(c)(err)).then(checkAndRun)\n              }\n            })\n\n          return results[c]\n        }\n\n        // Kick off x number of initial threads\n        while (initialThread < threadLimit && initialThread < args.length) runItem(initialThread++)\n      })\n    }))\n  }\n}\n","import utils from './modules/utils'\n\nconst { isPromiseLike } = utils\n\nexport default function conditional(FP) {\n  return { tapIf, thenIf, _thenIf }\n\n  function thenIf(cond, ifTrue, ifFalse) {\n    if (this.steps) return this.addStep('thenIf', [...arguments])\n    if (arguments.length === 1) {\n      ifTrue = cond\n      cond = x => x\n    }\n    if (isPromiseLike(this)) {\n      return this.then(value => _thenIf(cond, ifTrue, ifFalse)(value))\n    }\n    return _thenIf(cond, ifTrue, ifFalse)\n  }\n\n  function tapIf(cond, ifTrue, ifFalse) {\n    if (this.steps) return this.addStep('tapIf', [...arguments])\n    if (arguments.length === 1) {\n      ifTrue = cond\n      cond = x => x\n    }\n    if (isPromiseLike(this)) {\n      return this.then(value => _thenIf(cond, ifTrue, ifFalse, true)(value))\n    }\n    return _thenIf(cond, ifTrue, ifFalse, true)\n  }\n\n  function _thenIf(cond = x => x, ifTrue = x => x, ifFalse = () => null, returnValue = false) {\n    return value =>\n      FP.resolve(cond(value))\n        .then(ans => (ans ? ifTrue(value) : ifFalse(value)))\n        .then(v => (returnValue ? value : v))\n  }\n}\n","import { FunctionalError } from './modules/errors'\nimport utils from './modules/utils'\nimport monads from './monads'\nimport arrays from './arrays'\nimport { listen } from './events'\nimport conditional from './conditional'\nimport promise from './promise'\n\n\nconst { isFunction, flatten } = utils\nconst { map, find, findIndex, filter, flatMap, reduce } = arrays(FP)\nconst { all, reject, delay, _delay } = promise(FP)\nconst { tapIf, thenIf, _thenIf } = conditional(FP)\nconst { chain, chainEnd } = monads(FP)\n\nFP.prototype.all = all\nFP.prototype.map = map\nFP.prototype.find = find\nFP.prototype.findIndex = findIndex\nFP.prototype.filter = filter\nFP.prototype.flatMap = flatMap\nFP.prototype.reduce = reduce\nFP.prototype.listen = listen\nFP.prototype.tapIf = tapIf\nFP.prototype.thenIf = thenIf\nFP.prototype._thenIf = _thenIf\nFP.prototype.delay = delay\nFP.prototype._delay = _delay\nFP.prototype.reject = reject\n\n// FP.default = FP\n// export const all = allPromises\n\nFP.all = FP.prototype.all\nFP.thenIf = FP.prototype._thenIf\nFP.delay = msec => FP.resolve().delay(msec)\nFP.silent = limit => FP.resolve().silent(limit)\n\n// Monadic Methods\nFP.chain = chain\nFP.prototype.chainEnd = chainEnd\nFP.reject = FP.prototype.reject\nFP.resolve = resolve\n\nFP.promisify = promisify\nFP.promisifyAll = promisifyAll\nFP.unpack = unpack\n\nFP.prototype.addStep = function addStep(name, args) {\n  if (this.steps) this.steps.push([name, this, args])\n  return this\n}\n\nFP.prototype.concurrency = function concurrency(limit = Infinity) {\n  if (this.steps) return this.addStep('concurrency', [...arguments])\n  this._FP.concurrencyLimit = limit\n  return this\n}\n\nFP.prototype.quiet = function quiet(errorLimit = Infinity) {\n  if (this.steps) return this.addStep('quiet', [...arguments])\n  this._FP.errors = { count: 0, limit: errorLimit }\n  return this\n}\nFP.prototype.silent = FP.prototype.quiet\n\n/**\n * Helper to accumulate string keys *until an object is provided*. \n * Returns a partial function to accept more keys until partial \n */\nFP.get = function getter(...getArgs) {\n  getArgs = flatten(getArgs)\n  const keyNames = getArgs.filter(s => typeof s === 'string')\n  const objectFound = getArgs.find(s => typeof s !== 'string')\n  // Return partial app / auto-curry deal here\n  if (!objectFound) { // return function to keep going\n    return (...extraArgs) => FP.get(...extraArgs, ...getArgs)\n  }\n\n  if (keyNames.length === 1) return objectFound[keyNames[0]]\n  return keyNames.reduce((extracted, key) => {\n    extracted[key] = objectFound[key]\n    return extracted\n  }, {})\n\n}\n\nFP.prototype.get = function get(...keyNames) {\n  if (this.steps) return this.addStep('get', [...arguments])\n  return this.then\n     ? this.then(FP.get(keyNames))\n     : FP.get(...keyNames)\n}\n\nFP.prototype.set = function set(keyName, value) {\n  if (this.steps) return this.addStep('set', [...arguments])\n  return this.then(obj => {\n    if (typeof obj === 'object') obj[keyName] = value\n    return obj\n  })\n}\n\nFP.prototype.catch = function (fn) {\n  if (this.steps) return this.addStep('catch', [...arguments])\n  if (arguments.length === 2) return this.catchIf(...arguments)\n  if (!isFunction(fn)) throw new FunctionalError('Invalid fn argument for `.catch(fn)`. Must be a function. Currently: ' + typeof fn)\n  return FP.resolve(this._FP.promise.catch(err => fn(err)))\n}\n\nFP.prototype.catchIf = function catchIf(condition, fn) {\n  if (this.steps) return this.addStep('catchIf', [...arguments])\n  if (!isFunction(fn)) throw new FunctionalError('Invalid fn argument for `.catchIf(condition, fn)`. Must be a function. Currently: ' + typeof fn)\n\n  return FP.resolve(this._FP.promise.catch(err => {\n    if (condition && err instanceof condition) return fn(err) // try re-throw, might be really slow...\n    throw err\n  }))\n}\n\nFP.prototype.then = function then(fn) {\n  if (this.steps) return this.addStep('then', [...arguments])\n  if (!isFunction(fn)) throw new FunctionalError('Invalid fn argument for `.then(fn)`. Must be a function. Currently: ' + typeof fn)\n  return FP.resolve(this._FP.promise.then(fn))\n}\n\nFP.prototype.tap = function tap(fn) {\n  if (this.steps) return this.addStep('tap', [...arguments])\n  if (!isFunction(fn)) throw new FunctionalError('Invalid fn argument for `.tap(fn)`. Must be a function. Currently: ' + typeof fn)\n  return FP.resolve(this._FP.promise.then(value => fn(value) ? value : value))\n}\n\nfunction resolve(value) {\n  return new FP((resolve, reject) => {\n    if (value && isFunction(value.then)) return value.then(resolve).catch(reject)\n    resolve(value)\n  })\n}\n\nfunction promisify(cb) {\n  return (...args) => new FP((yah, nah) =>\n    cb.call(this, ...args, (err, res) => err ? nah(err) : yah(res)))\n}\n\nfunction promisifyAll(obj) {\n  if (!obj || !Object.getPrototypeOf(obj)) { throw new Error('Invalid Argument obj in promisifyAll(obj)') }\n  return Object.getOwnPropertyNames(obj)\n    .filter(key => typeof obj[key] === 'function')\n    .reduce((obj, fnName) => {\n      if (!/Sync/.test(fnName) && !obj[`${fnName}Async`]) obj[`${fnName}Async`] = FP.promisify(obj[`${fnName}`])\n      return obj\n    }, obj)\n}\n\nfunction unpack() {\n  let resolve, reject, promise = new FP((yah, nah) => { resolve = yah; reject = nah })\n  return { promise, resolve, reject }\n}\n\n\nexport default function FP(resolveRejectCB) {\n  if (!(this instanceof FP)) { return new FP(resolveRejectCB) }\n  if (arguments.length !== 1) throw new Error('FunctionalPromises constructor only accepts 1 callback argument')\n  this._FP = {\n    errors:           { limit: 0, count: 0 },\n    promise:          new Promise(resolveRejectCB),\n    concurrencyLimit: 4,\n  }\n}\n// if (process && process.on) {\n//   // process.on('uncaughtException', e => console.error('FPromises: FATAL EXCEPTION: uncaughtException', e))\n//   process.on('unhandledRejection', e => console.error('FPromises: FATAL ERROR: unhandledRejection', e))\n// }\n","import { FPInputError } from './modules/errors'\n\nexport default function(FP) {\n\n  return { all, reject, delay, _delay }\n\n  function all(promises) {\n    return FP.resolve(Array.isArray(promises) ? Promise.all(promises) : promiseAllObject(promises))\n  }\n\n  function promiseAllObject(obj) {\n    const keys = Object.getOwnPropertyNames(obj)\n    const values = keys.map(key => obj[key])\n    return Promise.all(values).then(results => results.reduce((obj, val, index) => {\n      const key = keys[index]\n      return Object.assign({ [key]: val }, obj)\n    }, {}))\n  }\n\n  function reject(err) {\n    if (err instanceof Error) {\n      if (this) this._error = err\n      return Promise.reject(err)\n    }\n    throw new Error(`Reject only accepts a new instance of Error!`)\n  }\n\n  function _delay(msec) {\n    if (!Number.isInteger(msec)) throw new FPInputError('FP.delay(millisec) requires a numeric arg.')\n    return value => new FP(resolve => { setTimeout(() => resolve(value), msec) })\n  }\n\n  function delay(msec) {\n    if (this.steps) return this.addStep('delay', [...arguments])\n    return this && this._FP ? FP.resolve(this.then(_delay(msec))) : _delay(msec)()\n  }\n}\n","import { FPInputError } from './modules/errors'\n\nexport default function monads(FP) {\n\n  return {chain, chainEnd}\n\n  /**\n   * Start 'recording' a chain of commands, after steps defined call `.chainEnd()`\n   * @returns FunctionalPromise\n   */\n  function chain() {\n    // create a placeholder/initial promise to hold the steps/chain data\n    const promise = FP.resolve()\n    promise.steps = []\n    return promise\n  }\n\n  /**\n   * Call after starting a `.chain()`.\n   *\n   * One of the few non-chainable methods in the API.\n   * @returns a Function. It runs your functional chain!\n   */\n  function chainEnd() {\n    return input => {\n      if (!this.steps || this.steps.length <= 0) throw new FPInputError('No steps defined between .chain() & .chainEnd()')\n      let stepCount = 0\n      let {promise, resolve, reject} = FP.unpack()\n      while (stepCount < this.steps.length) {\n        const [fnName, , args] = this.steps[stepCount]\n        promise = promise[fnName](...args)\n        stepCount++\n      }\n      resolve(input)\n      return promise\n    }\n  }\n}\n","import { FPInputError } from './modules/errors'\n\nexport const listen = function listen(obj, ...eventNames) {\n  if (typeof eventNames === 'string') eventNames = [eventNames]\n  if (!obj[obj.addEventListener ? 'addEventListener' : 'on']) throw new FPInputError('Valid EventEmitter required.')\n  // Gets callback to attach to the event handlers\n  const handler = this.chainEnd()\n  this._FP.destroy = () => this._FP.destroyHandles.map(fn => fn() || true).filter(v => v).length\n  this._FP.destroyHandles = eventNames.map(eventName => {\n    obj[obj.addEventListener ? 'addEventListener' : 'on'](eventName, handler)\n    return () => obj[obj.removeEventListener ? 'removeEventListener' : 'off'](eventName, handler)\n  })\n  return this\n}"],"names":["_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Date","prototype","toString","call","e","isNativeReflectConstruct","a","push","apply","instance","Function","bind","arguments","inherits","require","FunctionalError","msg","options","this","message","Error","getOwnPropertyNames","forEach","key","_this","name","constructor","captureStackTrace","FPInputError","FPCollectionError","FunctionalUserError","FPUnexpectedError","FPTimeout","utils","isPromiseLike","then","isFunction","fn","isEnumerable","list","Array","isArray","Symbol","iterator","isObject","flatten","arr","reduce","results","item","concat","FP","map","steps","addStep","length","_FP","promise","resolvedOrRejected","threadLimit","Math","max","concurrencyLimit","innerValues","Promise","resolve","initialThread","errors","count","threadPool","Set","setResult","index","value","reject","resolveIt","x","rejectIt","items","complete","action","limit","all","data","checkAndRun","val","runItem","c","size","setTimeout","add","err","fpErr","ctx","find","callback","_find","findIndex","filter","iterable","acc","flatMap","undefined","indexOf","reducer","initVal","i","next","total","current","done","promises","obj","keys","values","assign","promiseAllObject","_error","delay","msec","_delay","Number","isInteger","tapIf","cond","ifTrue","ifFalse","_thenIf","thenIf","returnValue","ans","v","chain","chainEnd","input","stepCount","unpack","fnName","resolveRejectCB","listen","eventNames","addEventListener","handler","destroy","destroyHandles","eventName","removeEventListener","silent","promisify","cb","yah","nah","res","promisifyAll","getPrototypeOf","test","concurrency","Infinity","quiet","errorLimit","get","getArgs","keyNames","s","objectFound","extracted","extraArgs","set","keyName","catchIf","condition","tap"],"mappings":"kOAAe,SAASA,EAAgBC,EAAGC,GAMzC,OALAF,EAAkBG,OAAOC,gBAAkB,SAAyBH,EAAGC,GAErE,OADAD,EAAEI,UAAYH,EACPD,IAGcA,EAAGC,GCJb,SAASI,EAAWC,EAAQC,EAAMC,GAc/C,OAVEH,ECNW,WACb,GAAuB,oBAAZI,SAA4BA,QAAQC,YAC3CD,QAAQC,UAAUC,KAAtB,CACA,GAAqB,mBAAVC,MAAsB,OAAO,EAExC,IAEE,OADAC,KAAKC,UAAUC,SAASC,KAAKP,QAAQC,UAAUG,KAAM,GAAI,eAClD,EACP,MAAOI,GACP,SDNEC,GACWT,QAAQC,UAER,SAAoBJ,EAAQC,EAAMC,GAC7C,IAAIW,EAAI,CAAC,MACTA,EAAEC,KAAKC,MAAMF,EAAGZ,GAChB,IACIe,EAAW,IADGC,SAASC,KAAKH,MAAMf,EAAQa,IAG9C,OADIX,GAAOL,EAAemB,EAAUd,EAAMM,WACnCQ,IAIOD,MAAM,KAAMI,ghLEhBxBC,cAAaC,QAAQ,SAArBD,SAUD,SAASE,EAAgBC,EAAKC,yCAC7BC,gBAAgBH,qCAA6BA,6BAAmBH,qCACnD,iBAARI,6BACTC,EAAUD,cACLC,EAAQE,mCAAUH,EAAMC,EAAQE,kDAEvCC,MAAMjB,KAAKe,KAAMF,eACE,iBAARA,kCAAuBG,QAAUH,6BACrB,iBAAZC,6BACT5B,OAAOgC,oBAAoBJ,GACxBK,QAAQ,SAAAC,0BACPC,EAAKD,GAAON,EAAQM,qCAGrBE,KAAOP,KAAKQ,YAAYD,iBAE7BL,MAAMO,kBAAkBT,MAanB,SAASU,gCACRV,gBAAgBU,sCAA0BA,6BAAgBhB,sCAChEG,EAAgBZ,WAAhBY,GAAqBG,wCAASN,aAGzB,SAASiB,gCACRX,gBAAgBW,sCAA+BA,6BAAqBjB,sCAC1EG,EAAgBZ,WAAhBY,GAAqBG,wCAASN,2uFA5ChCC,EAASE,EAAiBK,kBAE1BP,EAyBO,SAASiB,iCACRZ,gBAAgBY,sCAAiCA,6BAAuBlB,sCAC9EG,EAAgBZ,WAAhBY,GAAqBG,wCAASN,cA3BFG,cAC9BF,EAASgB,EAAmBd,cAC5BF,EA4BO,SAASkB,iCACRb,gBAAgBa,sCAA+BA,6BAAqBnB,sCAC1EG,EAAgBZ,WAAhBY,GAAqBG,wCAASN,cA9BJG,cAC5BF,EAASe,EAAcb,cACvBF,EAyCO,SAASmB,iCACRd,gBAAgBc,sCAAuBA,6BAAapB,sCAC1DG,EAAgBZ,WAAhBY,GAAqBG,wCAASN,cA3CZG,OCRpB,IAAMkB,cAAQ,CACZC,uBAAc9C,iDAAeA,kBAAuB,mBAAXA,EAAE+C,QAC3CC,oBAAWC,gCAA2B,mBAAPA,GAC/BC,sBAAaC,8CAAeA,kBAAQC,MAAMC,QAAQF,oBAASA,kBAAyC,mBAA1BA,EAAKG,OAAOC,aACtFC,kBAASzD,gCAAoD,sBAAtCE,OAAOY,UAAUC,SAASC,KAAKhB,IAEtD0D,iBAAQC,6BACDN,MAAMC,QAAQK,kCAAY,IAAI1B,MAAM,mFAClC0B,EAAIC,OAAO,SAACC,EAASC,gCAASD,EAAQE,OAAOV,MAAMC,QAAQQ,kBAAQhB,EAAMY,QAAQI,mBAAQ,CAACA,MAAQ,+5uBCNrGX,cAAiBL,GAAjBK,usTCAAJ,cAAkBD,GAAlBC,kgwBDEgBiB,gBEKQlB,GAAxBG,IAAAA,WAAYS,IAAAA,sBFLIM,EEMyCA,wBFJxD,CAAEC,aAmEI1D,EAAM2C,EAAIpB,yCACjBC,KAAKmC,wCAAcnC,KAAKoC,QAAQ,iCAAW1C,sDACtB,IAArBA,UAAU2C,wBAAgBrC,uBAAQA,KAAKsC,iCACzCnB,EAAK3C,6BACLA,wBAAewB,KAAKsC,sBAAOtC,KAAKsC,IAAIC,6BAElCC,gBAAqB,GACnBC,eAAcC,KAAKC,IAAI,wCAAY3C,KAAKsC,sBAAOtC,KAAKsC,IAAIM,mCAAoB,MAC5EC,oDAAsB7C,KAAKsC,sBAAOtC,KAAKsC,IAAIC,yBAAUvC,KAAKsC,IAAIC,yBAAUO,QAAQC,QAAQvE,KAC1FwE,eAAgB,GAChBC,eAAS,IACTC,eAAQ,GACNpB,eAAU,IACVqB,eAAa,IAAIC,KAGL,SAAZC,EAAYC,2CAASC,kCACzBJ,SAAkBG,eAClBxB,EAAQwB,GAASC,cACVA,0DAEFtB,EAAGc,QAAQ,IAAID,QAAQ,SAACC,EAASS,GACpB,SAAZC,EAAYC,8BAEZlB,oCAA6B,gCAAcA,GAAqB,cACpEO,EAAQW,GAEO,SAAXC,EAAWD,8BACXlB,oCAA6B,gCAAcA,GAAqB,cAEpEgB,EAAOE,mDAETb,EAAY5B,KAAK,SAAA2C,+BACVxC,EAAawC,qCAAeJ,EAAO,IAAI7C,uCAAuDiD,iCAElF,SAAXC,oBACAC,eAAS,yBACTb,EAAOZ,OAAS/B,EAAKgC,IAAIW,OAAOc,kCAAOD,EAASH,qEAtBrCV,EAAOZ,OAAS/B,EAAKgC,IAAIW,OAAOc,uBAASb,GAAS1E,EAAK6D,yBAAUG,+BAuBlEsB,EAASL,8BACnBK,8BAAehB,QAAQkB,IAAIlC,GAASb,KAAK,SAAAgD,kCAAQH,EAAOhC,mCAAY,+BACjE,GAEW,SAAdoC,EAAcC,kCAEd3B,+EACCqB,qBAAe/B,EAAQoB,+CAAQkB,EAAQlB,gBACrCiB,8BAZT3F,YAAWoF,2CAeLQ,EAAU,SAAVA,EAAUC,mCACV7B,+BAA4B,mCAAYU,yCApCrBC,EAAWmB,MAAQ7B,+BAqCb8B,WAAW,2CAAMH,EAAQC,IAAI,iCACtDvC,EAAQuC,8DACZlB,EAAWqB,IAAIH,gBAEfvC,EAAQuC,GAAKvB,QAAQC,QAAQvE,EAAK6F,IAC/BpD,KAAK,SAAAkD,mCAAOhD,EAAGgD,EAAKE,EAAG7F,KACvByC,KAAK,SAAAkD,mCAAOd,EAAUgB,EAAVhB,CAAac,KACzBlD,KAAKiD,SACC,SAAAO,+BACLnE,EAAKgC,IAAIW,OAAOC,qBAChBD,EAAO5D,KAAKoF,gBACRnE,EAAKgC,IAAIW,OAAOc,OAAS,qCAC3BJ,EAASc,gBACFA,mCAELxB,EAAOZ,OAAS/B,EAAKgC,IAAIW,OAAOc,0CAK3BjB,QAAQC,UAAU9B,KAAK,2CAAMoC,EAAUgB,EAAVhB,CAAaoB,KAAMxD,KAAKiD,sBAJxDQ,gBAAyB,GAAjBzB,EAAOZ,uBAAc,IAAI1B,iBAAiCL,EAAKgC,IAAIW,OAAOc,yCAChFM,aAAY/D,EAAKgC,IAAIW,OAAOC,MAAS,CAAED,OAAAA,EAAQnB,QAAAA,EAAS6C,IAAKrE,qBAAUmE,iBAC7E3B,QAAQC,QAAQM,EAAUgB,EAAVhB,CAAaoB,IAAMxD,KAAK,2CAAM0C,EAASe,qBAjBtC5C,EAAQuC,sCA2B1BrB,EAAgBP,mBAAeO,EAAgBxE,EAAK6D,sBAAQ+B,EAAQpB,WAlJnE4B,cAEAC,gCAAmBC,EAAM7F,KAAKe,KAAM6E,GAAU5D,KAAK,gBAAGc,IAAAA,kCAAWA,KAF3DgD,mBAGDF,gCAAmBC,EAAM7F,KAAKe,KAAM6E,GAAU5D,KAAK,gBAAGqC,IAAAA,mCAAYA,KAHtD0B,gBA8BfC,EAAUJ,iCACpB7E,KAAKmC,iCAAcnC,KAAKoC,QAAQ,oCAAc1C,wCAC1B,mBAAbuF,6BACTJ,EAAWI,cACXA,EAAWjF,KAAKsC,IAAIC,mCAGfV,EAAO5C,KAAKe,KAAMiF,EAAU,SAACC,EAAKnD,kCAASe,QAAQC,QAAQ8B,EAAS9C,IAAOd,KAAK,SAAAyC,kCAAMA,iBAAIwB,EAAIlD,OAAO,CAACD,oBAASmD,MAAO,MArCxFC,iBAiBtBF,EAAUJ,iCACrB7E,KAAKmC,iCAAcnC,KAAKoC,QAAQ,qCAAe1C,wCAC3B,mBAAbuF,6BACTJ,EAAWI,cACXA,EAAWjF,KAAKsC,IAAIC,mCAGfN,EAAGc,QAAQkC,GACf/C,IAAI2C,GACJhD,OAAO,SAACqD,EAAKtD,iCAAQsD,EAAIlD,aAAJkD,EAActD,IAAM,MA1BEC,OAAAA,IEI1CK,IAAAA,IAAK0C,IAAAA,KAAMG,IAAAA,UAAWC,IAAAA,OAAQG,IAAAA,QAAStD,IAAAA,gBFCpCiD,EAAMG,EAAUJ,gCACnB7E,KAAKmC,gCAAcnC,KAAKoC,QAAQ,mCAAa1C,uCACzB,mBAAbuF,4BACTJ,EAAWI,cACXA,EAAWjF,KAAKsC,IAAIC,mCAGfN,EAAGc,QAAQkC,GACfD,OAAOH,GACP5D,KAAK,SAACa,iCAA0BsD,MAAdtD,EAAQ,kBAAkB,CAAEC,KAAMD,EAAQ,GAAIwB,MAAOxB,EAAQuD,QAAQvD,EAAQ,qBAAQ,CAAEC,UAAMqD,EAAW9B,OAAQ,gBA0B9HzB,EAAOoD,EAAUK,EAASC,kCAC7BvF,KAAKmC,iCAAcnC,KAAKoC,QAAQ,oCAAc1C,wCAIhDuF,EAHsB,mBAAbA,6BACTM,EAAUD,cACVA,EAAUL,cACCjF,KAAKsC,oBAAMtC,KAAKsC,IAAIC,yBAAUvC,kCACzBiC,EAAGc,QAAQkC,EAAUjF,mBAEhC,IAAIiC,EAAG,SAACc,EAASS,kCACfyB,EAAShE,KAAK,SAAAgE,mBACbxD,eAAWwD,EAASzD,OAAOC,aAC7B+D,eAAI,2BAEK,SAAPC,EAAOC,mBACLC,eAAUlE,EAASgE,uBACrBE,EAAQC,uCAAa7C,EAAQ2C,8BAEjC5C,QAAQkB,IAAI,CAAC0B,EAAOC,EAAQpC,QACzBtC,KAAK,gBAAEyE,OAAO3D,sCAAU0D,EAAKH,EAAQI,EAAO3D,EAAMyD,cAAahC,GAGpEiC,CAAKF,YGjEWtD,gBAAAA,EDSuBA,wBCPtC,CAAE+B,aAEI6B,gCACJ5D,EAAGc,QAAQzB,MAAMC,QAAQsE,kBAAY/C,QAAQkB,IAAI6B,4BAGhCC,kBAClBC,cAAO5H,OAAOgC,oBAAoB2F,IAClCE,cAASD,EAAK7D,IAAI,SAAA7B,gCAAOyF,EAAIzF,wBAC5ByC,QAAQkB,IAAIgC,GAAQ/E,KAAK,SAAAa,gCAAWA,EAAQD,OAAO,SAACiE,EAAK3B,EAAKb,wBAC7DjD,cAAM0F,EAAKzC,sBACVnF,OAAO8H,eAAU5F,GAAM8D,KAAO2B,IACpC,MATiEI,CAAiBL,MAHzErC,gBAeEiB,4BACVA,aAAevE,uCACbF,qCAAWmG,OAAS1B,6BACjB3B,QAAQU,OAAOiB,mCAElB,IAAIvE,uDApBUkG,eA4BPC,kCACTrG,KAAKmC,iCAAcnC,KAAKoC,QAAQ,mCAAa1C,2EAClCM,KAAKsC,oBAAML,EAAGc,QAAQ/C,KAAKiB,KAAKqF,EAAOD,qBAAUC,EAAOD,EAAPC,MA9BrCA,OAAAA,IDOvBtC,IAAAA,IAAKR,IAAAA,OAAQ4C,IAAAA,MAAOE,IAAAA,gBCgBjBA,EAAOD,8BACTE,OAAOC,UAAUH,mCAAa,IAAI3F,EAAa,+EAC7C,SAAA6C,qCAAatB,EAAG,SAAAc,0BAAawB,WAAW,0CAAMxB,EAAQQ,IAAQ8C,UFzBrCpE,gBAAAA,ECQWA,wBDPtC,CAAEwE,eAcMC,EAAMC,EAAQC,iCACvB5G,KAAKmC,iCAAcnC,KAAKoC,QAAQ,mCAAa1C,wCACxB,IAArBA,UAAU2C,kCACZsE,EAASD,cACTA,EAAO,SAAAhD,iCAAKA,8BAEV1C,EAAchB,iCACTA,KAAKiB,KAAK,SAAAsC,iCAASsD,EAAQH,EAAMC,EAAQC,GAAS,EAA/BC,CAAqCtD,iCAE1DsD,EAAQH,EAAMC,EAAQC,GAAS,MAvBxBE,gBAEAJ,EAAMC,EAAQC,gCACxB5G,KAAKmC,gCAAcnC,KAAKoC,QAAQ,oCAAc1C,uCACzB,IAArBA,UAAU2C,iCACZsE,EAASD,aACTA,EAAO,SAAAhD,gCAAKA,6BAEV1C,EAAchB,gCACTA,KAAKiB,KAAK,SAAAsC,iCAASsD,EAAQH,EAAMC,EAAQC,EAAtBC,CAA+BtD,iCAEpDsD,EAAQH,EAAMC,EAAQC,MAXPC,QAAAA,ICOlBJ,IAAAA,MAAOK,IAAAA,OAAQD,IAAAA,iBDmBZA,EAAQH,EAAeC,EAAiBC,EAAsBG,mBAAtDL,kBAAAA,EAAO,SAAAhD,iCAAKA,aAAGiD,kBAAAA,EAAS,SAAAjD,iCAAKA,aAAGkD,kBAAAA,EAAU,0DAAYG,kBAAAA,GAAc,0BAC5E,SAAAxD,kCACLtB,EAAGc,QAAQ2D,EAAKnD,IACbtC,KAAK,SAAA+F,kCAAQA,kBAAML,EAAOpD,oBAASqD,EAAQrD,MAC3CtC,KAAK,SAAAgG,kCAAMF,kBAAcxD,mBAAQ0D,UGjCXhF,gBAAAA,EFWIA,wBET1B,CAACiF,gCAQA3E,cAAUN,EAAGc,6BACnBR,EAAQJ,MAAQ,cACTI,GAVM4E,4DAoBN,SAAAC,2CACA9G,EAAK6B,sBAAS7B,EAAK6B,MAAME,QAAU,kCAAS,IAAI3B,EAAa,qEAC9D2G,cAAY,iBACiBpF,EAAGqF,UAA/B/E,IAAAA,QAASQ,IAAAA,cAASS,kBAChB6D,EAAY/G,EAAK6B,MAAME,QAAQ,oBACX/B,EAAK6B,MAAMkF,IAA7BE,OAAU/I,mBACjB+D,EAAUA,EAAQgF,SAARhF,EAAmB/D,eAC7B6I,uBAEFtE,EAAQqE,eACD7E,MFrBL2E,IAAAA,MAAOC,IAAAA,SAkJA,SAASlF,EAAGuF,iCACnBxH,gBAAgBiC,sCAAc,IAAIA,EAAGuF,kCAClB,IAArB9H,UAAU2C,yCAAoB,IAAInC,MAAM,oGACvCoC,IAAM,CACTW,OAAkB,CAAEc,MAAO,EAAGb,MAAO,GACrCX,QAAkB,IAAIO,QAAQ0E,GAC9B5E,iBAAkB,qBAtJtBX,EAAGlD,UAAUiF,IAAMA,aACnB/B,EAAGlD,UAAUmD,IAAMA,aACnBD,EAAGlD,UAAU6F,KAAOA,aACpB3C,EAAGlD,UAAUgG,UAAYA,aACzB9C,EAAGlD,UAAUiG,OAASA,cACtB/C,EAAGlD,UAAUoG,QAAUA,cACvBlD,EAAGlD,UAAU8C,OAASA,cACtBI,EAAGlD,UAAU0I,OGpBS,SAAgB3B,qCAAQ4B,mCAAAA,6CAClB,iBAAfA,4BAAyBA,EAAa,CAACA,8BAC7C5B,EAAIA,EAAI6B,gCAAmB,mCAAqB,sCAAa,IAAIjH,EAAa,kDAE7EkH,cAAU5H,KAAKmH,mCAChB7E,IAAIuF,QAAU,wCAAMvH,EAAKgC,IAAIwF,eAAe5F,IAAI,SAAAf,8CAAMA,qBAAQ,KAAM6D,OAAO,SAAAiC,gCAAKA,IAAG5E,yBACnFC,IAAIwF,eAAiBJ,EAAWxF,IAAI,SAAA6F,iCACvCjC,EAAIA,EAAI6B,gCAAmB,mCAAqB,OAAMI,EAAWH,eAC1D,yCAAM9B,EAAIA,EAAIkC,mCAAsB,sCAAwB,QAAOD,EAAWH,kBAEhF5H,kBHWTiC,EAAGlD,UAAU0H,MAAQA,cACrBxE,EAAGlD,UAAU+H,OAASA,cACtB7E,EAAGlD,UAAU8H,QAAUA,cACvB5E,EAAGlD,UAAUqH,MAAQA,cACrBnE,EAAGlD,UAAUuH,OAASA,cACtBrE,EAAGlD,UAAUyE,OAASA,cAKtBvB,EAAG+B,IAAM/B,EAAGlD,UAAUiF,gBACtB/B,EAAG6E,OAAS7E,EAAGlD,UAAU8H,oBACzB5E,EAAGmE,MAAQ,SAAAC,iCAAQpE,EAAGc,UAAUqD,MAAMC,gBACtCpE,EAAGgG,OAAS,SAAAlE,iCAAS9B,EAAGc,UAAUkF,OAAOlE,gBAGzC9B,EAAGiF,MAAQA,cACXjF,EAAGlD,UAAUoI,SAAWA,cACxBlF,EAAGuB,OAASvB,EAAGlD,UAAUyE,mBACzBvB,EAAGc,QAyFH,SAAiBQ,mCACR,IAAItB,EAAG,SAACc,EAASS,8CAClBD,mBAASrC,EAAWqC,EAAMtC,0CAAcsC,EAAMtC,KAAK8B,SAAeS,+BACtET,EAAQQ,kBA1FZtB,EAAGiG,UA8FH,SAAmBC,8CACV,sCAAI3J,2BAAAA,sDAAayD,EAAG,SAACmG,EAAKC,mCAC/BF,EAAGlJ,WAAHkJ,GAAQ7H,UAAS9B,GAAM,SAACiG,EAAK6D,mCAAQ7D,kBAAM4D,EAAI5D,oBAAO2D,EAAIE,wBA/F9DrG,EAAGsG,aAkGH,SAAsBzC,gDACfA,oBAAQ3H,OAAOqK,eAAe1C,sCAAc,IAAI5F,MAAM,gFACpD/B,OAAOgC,oBAAoB2F,GAC/Bd,OAAO,SAAA3E,mCAA2B,mBAAbyF,EAAIzF,KACzBwB,OAAO,SAACiE,EAAKyB,kDACP,OAAOkB,KAAKlB,oBAAYzB,EAAOyB,wDAAgBzB,EAAOyB,WAAiBtF,EAAGiG,UAAUpC,KAAOyB,kBACzFzB,GACNA,gBAxGP7D,EAAGqF,OA2GH,2BACMvE,EAASS,EAAQjB,gBAAU,IAAIN,EAAG,SAACmG,EAAKC,4BAAUtF,EAAUqF,eAAK5E,EAAS6E,yBACvE,CAAE9F,QAAAA,EAASQ,QAAAA,EAASS,OAAAA,gBA3G7BvB,EAAGlD,UAAUqD,QAAU,SAAiB7B,EAAM/B,iCACxCwB,KAAKmC,sCAAYA,MAAM9C,KAAK,CAACkB,EAAMP,KAAMxB,+BACtCwB,kBAGTiC,EAAGlD,UAAU2J,YAAc,SAAqB3E,mBAAAA,kBAAAA,EAAQ4E,EAAAA,0BAClD3I,KAAKmC,iCAAcnC,KAAKoC,QAAQ,yCAAmB1C,6CAClD4C,IAAIM,iBAAmBmB,cACrB/D,mBAGTiC,EAAGlD,UAAU6J,MAAQ,SAAeC,mBAAAA,kBAAAA,EAAaF,EAAAA,0BAC3C3I,KAAKmC,iCAAcnC,KAAKoC,QAAQ,mCAAa1C,6CAC5C4C,IAAIW,OAAS,CAAEC,MAAO,EAAGa,MAAO8E,eAC9B7I,mBAETiC,EAAGlD,UAAUkJ,OAAShG,EAAGlD,UAAU6J,kBAMnC3G,EAAG6G,IAAM,sCAAmBC,2BAAAA,yCAC1BA,EAAUpH,EAAQoH,OACZC,eAAWD,EAAQ/D,OAAO,SAAAiE,iCAAkB,iBAANA,KACtCC,eAAcH,EAAQnE,KAAK,SAAAqE,iCAAkB,iBAANA,wBAExCC,6BAImB,IAApBF,EAAS3G,kCAAqB6G,EAAYF,EAAS,gCAChDA,EAASnH,OAAO,SAACsH,EAAW9I,iCACjC8I,EAAU9I,GAAO6I,EAAY7I,eACtB8I,GACN,iCAPM,6DAAIC,2BAAAA,yBAAcnH,EAAG6G,UAAH7G,EAAUmH,SAAcL,mBAWrD9G,EAAGlD,UAAU+J,IAAM,sCAAgBE,2BAAAA,iDAC7BhJ,KAAKmC,iCAAcnC,KAAKoC,QAAQ,iCAAW1C,wCACxCM,KAAKiB,oBACPjB,KAAKiB,KAAKgB,EAAG6G,IAAIE,oBACjB/G,EAAG6G,UAAH7G,EAAU+G,kBAGjB/G,EAAGlD,UAAUsK,IAAM,SAAaC,EAAS/F,kCACnCvD,KAAKmC,iCAAcnC,KAAKoC,QAAQ,iCAAW1C,wCACxCM,KAAKiB,KAAK,SAAA6E,kCACI,iBAARA,8BAAkBA,EAAIwD,GAAW/F,8BACrCuC,kBAIX7D,EAAGlD,gBAAkB,SAAUoC,8BACzBnB,KAAKmC,wCAAcnC,KAAKoC,QAAQ,mCAAa1C,0CACxB,IAArBA,UAAU2C,yCAAqBrC,KAAKuJ,mBAAW7J,0CAC9CwB,EAAWC,oCAAW,IAAItB,EAAgB,+EAAiFsB,qCACzHc,EAAGc,QAAQ/C,KAAKsC,IAAIC,cAAc,SAAAkC,kCAAOtD,EAAGsD,mBAGrDxC,EAAGlD,UAAUwK,QAAU,SAAiBC,EAAWrI,8BAC7CnB,KAAKmC,wCAAcnC,KAAKoC,QAAQ,qCAAe1C,2CAC9CwB,EAAWC,oCAAW,IAAItB,EAAgB,4FAA8FsB,qCAEtIc,EAAGc,QAAQ/C,KAAKsC,IAAIC,cAAc,SAAAkC,6CACnC+E,mBAAa/E,aAAe+E,qCAAkBrI,EAAGsD,oCAC/CA,kBAIVxC,EAAGlD,UAAUkC,KAAO,SAAcE,8BAC5BnB,KAAKmC,wCAAcnC,KAAKoC,QAAQ,kCAAY1C,2CAC3CwB,EAAWC,oCAAW,IAAItB,EAAgB,8EAAgFsB,qCACxHc,EAAGc,QAAQ/C,KAAKsC,IAAIC,QAAQtB,KAAKE,iBAG1Cc,EAAGlD,UAAU0K,IAAM,SAAatI,8BAC1BnB,KAAKmC,wCAAcnC,KAAKoC,QAAQ,iCAAW1C,2CAC1CwB,EAAWC,qCAAW,IAAItB,EAAgB,6EAA+EsB,sCACvHc,EAAGc,QAAQ/C,KAAKsC,IAAIC,QAAQtB,KAAK,SAAAsC,mCAASpC,EAAGoC,iCAASA"}